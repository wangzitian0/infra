# 0.check_now.md

## 1. What (Target)
Landing the Observability stack (L4) and finalizing Vault Database secret injection for L3 databases.

## 2. Why (Value)
- **Observability**: SigNoz integration for platform-wide metrics and tracing.
- **Security**: Dynamic DB credentials instead of static root passwords.

## 3. Where (Location)
- L2 Platform: `2.platform/6.vault-database.tf`
- L3 Data: `3.data/` (PostgreSQL, Redis, ClickHouse)
- L4 Apps: `4.apps/` (Signoz configuration)

## 4. Who (Owner)
Infra Platform / AI Assistant

## 5. When (Timeline)
Dec 19 - Ongoing.

## 6. How (Action Plan)

### Implementation Steps
- [ ] Finalize Vault PostgreSQL Database Engine configuration.
- [ ] Implement Vault Agent Sidecar injection for Redis/ClickHouse workloads in L3.
- [ ] Deploy SigNoz Helm chart in L4.
- [ ] Connect SigNoz to OTLP exporters.

---

## DONE (History)
- [x] [2025-12-19: CI/CD Secret Chain Refactoring (DRY & Shift-Left)](./docs/change_log/2025-12-19.ci_secrets_refactor.md)
- [x] [2025-12-19: Vault OIDC Permission Fix & Native Drift Defense](./docs/change_log/2025-12-19.vault_oidc_drift_defense.md)

---

## 7. Findings (Current Backlog)
- [ ] **中等** – `2.platform/90.casdoor-apps.tf:74-75` Casdoor 不可用时静默 `exit 0`，应改为 `exit 1` 或 输出明确 warning。
- [ ] **中等** – `2.platform/92.portal-auth.tf:81` OAuth2-Proxy scope 硬编码为 `openid profile email`，需确认 Casdoor 支持。
- [ ] **低** – `docs/ssot/db.redis.md` 描述的 Vault Agent 注入流程在 `3.data/2.redis.tf` 中没有体现，文档与代码对不上。
- [ ] **低** – `docs/ssot/platform.network.md:12-40` 介绍 NGINX 注释用于 Atlantis IP 白名单，但实际用的是 Traefik，注释无效。
