# 0.check_now.md

## 1. What (Target)
BRN-008: Infrastructure SSOT Refactor & Vault PostgreSQL Migration.

## 2. Why (Value)
Migrate Vault from Raft to PostgreSQL backend (Trust Anchor) to resolve circular dependencies and improve backup capabilities.

## 3. Where (Location)
- L1 Bootstrap: `1.bootstrap/5.platform_pg.tf`
- L2 Platform: `2.platform/2.secret.tf`
- Docs: `docs/ssot/`

## 4. Who (Owner)
Infra Team / AI Assistant (Antigravity)

## 5. When (Timeline)
Current Phase: Execution (Vault Migration)

## 6. How (Action Plan)

### Blocking Actions (Wait for User)
- [ ] **Merge PR #127**: Remove import block (Fixes L1 Deploy)
  - [PR Link](https://github.com/wangzitian0/infra/pull/127)
  - Triggers: Deploy k3s to VPS (Recreates platform namespace)
- [ ] **Atlantis Apply PR #125**: Deploy Vault PG backend
  - [PR Link](https://github.com/wangzitian0/infra/pull/125)
  - Comment: `atlantis apply` (AFTER PR #127 deploy succeeds)
- [ ] **Vault Init**: Re-initialize Vault
  - Command: `kubectl exec -n platform vault-0 -- vault operator init`

### Completed
- [x] Merge PR #119 (Design)
- [x] Merge PR #120 (P0 Infra)
- [x] Merge PR #121 (SSOT Docs)
- [x] Merge PR #122 (Namespace Import Fix)
- [x] Merge PR #123 (K3s SSOT Docs)
- [x] Merge PR #124 (PG Chart Version Fix)
- [x] Merge PR #126 (Import Block TODO - Merged but failed)

## Verification
- [ ] L1 Deploy Success (Green Check on main)
- [ ] Vault Pod Ready (`kubectl get pods -n platform`)
- [ ] Vault UI with PG Backend (`sys/health` or storage check)
