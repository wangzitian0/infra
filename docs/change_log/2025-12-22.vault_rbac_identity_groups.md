# 2025-12-22: Implement Vault RBAC with Identity Groups

## Context

Vault authentication previously relied on a simple OIDC role mapping or manual role selection (`role=vault-admin`). This was error-prone and provided a poor user experience. We needed a robust, automated way to map Casdoor roles to Vault permissions without manual intervention.

## Changes

1.  **Identity Groups Architecture**:
    *   Migrated from OIDC Role mapping to **Vault Identity Groups**.
    *   Configured a single `default` OIDC role as the entry point for all users.
    *   Vault now automatically reads the `roles` claim from the JWT token and maps it to internal Identity Groups.

2.  **Casdoor Roles (IaC)**:
    *   Created `2.platform/91.casdoor-roles.tf` to manage Casdoor roles (`vault-admin`, `vault-developer`, `vault-viewer`) via Terraform.

3.  **Permission Mapping**:
    *   `vault-admin` (Casdoor) -> `admin` Group -> `admin` Policy.
    *   `vault-developer` (Casdoor) -> `developer` Group -> `developer` Policy.
    *   Default -> `viewer` Group -> `viewer` Policy.

4.  **Documentation**:
    *   Updated `docs/ssot/platform.auth.md` with the new architecture and usage guide.
    *   Updated `2.platform/README.md` with component details.

## Verification

- **CI**: Terraform formatting and validation checks passed.
- **Docs**: `platform.auth.md` explains the "Login and Forget" flow.
- **Manual Verification (Pending Apply)**:
    1.  Apply changes via Atlantis.
    2.  Assign `vault-admin` role in Casdoor.
    3.  Login to Vault without specifying a role.
    4.  Verify Admin permissions are granted automatically.
