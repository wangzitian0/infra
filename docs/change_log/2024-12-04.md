# 2024-12-04 — infra 精简 & k3s 引导上线

## 做了什么
- 清理原有 Dokploy/compose/observability/ci 等目录，保留最小可运行集。
- `apps/` 改为 git submodule 指向 PEG-scaner，取消软链。
- 新增 Terraform 单节点 k3s 引导（`terraform/main.tf` + `scripts/install-k3s.sh.tmpl`），输出 kubeconfig。
- 新增 GitHub Actions `Deploy k3s to VPS`：fmt/init/plan/apply → 拉 kubeconfig → `kubectl get nodes` 冒烟 → artifact。
- 重写 README、AGENTS、文档导航，范围收敛到“CI 部署 k3s”。

## 如何验证
1. 准备 tfvars（或配置仓库 Secrets），包含 `VPS_HOST`、`VPS_SSH_KEY` 等。
2. 本地 `cd terraform && terraform init && terraform plan && terraform apply`，或直接跑 CI 工作流。
3. 查看 `terraform/output/<cluster>-kubeconfig.yaml`（或下载 artifact），设置 `KUBECONFIG` 后 `kubectl get nodes` 应返回主节点。

## 后续建议
- 在 k3s 上上线 PEG-scaner（Helm/manifest 任选），保持 infra → apps 单向依赖。
- 为 k3s 补充观测与 Backstage 健康面板，仍按 BRN-004 三层设计推进。
